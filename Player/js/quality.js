(function(c){var k={res_label:function(b){return/^\d+$/.test(b)?b+"p":b}};c.ResolutionMenuItem=c.MenuItem.extend({call_count:0,init:function(b,a){a.label=k.res_label(a.res);a.selected=a.res.toString()===b.getCurrentRes().toString();c.MenuItem.call(this,b,a);this.resolution=a.res;this.on(["click","tap"],this.onClick);b.on("changeRes",c.bind(this,function(){this.resolution==b.getCurrentRes()?this.selected(!0):this.selected(!1);this.call_count=0}))}});c.ResolutionMenuItem.prototype.onClick=function(){0<
this.call_count||(this.player().changeRes(this.resolution),this.call_count++)};c.ResolutionTitleMenuItem=c.MenuItem.extend({init:function(b,a){c.MenuItem.call(this,b,a);this.off("click")}});c.ResolutionSelector=c.MenuButton.extend({init:function(b,a){b.availableRes=a.available_res;c.MenuButton.call(this,b,a);this.el().firstChild.firstChild.innerHTML=a.buttonText}});c.ResolutionSelector.prototype.className="vjs-res-button";c.ResolutionSelector.prototype.createItems=function(){var b=this.player(),a=
[],g;a.push(new c.ResolutionTitleMenuItem(b,{el:c.Component.prototype.createEl("li",{className:"vjs-menu-title vjs-res-menu-title",innerHTML:b.localize("Quality")})}));for(g in b.availableRes)"length"!=g&&a.push(new c.ResolutionMenuItem(b,{res:g}));a.sort(function(a,b){return"undefined"==typeof a.resolution?-1:parseInt(b.resolution)-parseInt(a.resolution)});return a};c.plugin("resolutionSelector",function(b){if(this.el().firstChild.canPlayType){var a=this,g=a.options().sources,d=g.length;b=c.util.mergeOptions({default_res:"",
force_types:!1},b||{});for(var f={length:0},e,h=b.default_res&&"string"==typeof b.default_res?b.default_res.split(","):[];0<d;)d--,g[d]["data-res"]&&(e=g[d]["data-res"],"object"!==typeof f[e]&&(f[e]=[],f.length++),f[e].unshift(g[d]));if(b.force_types)for(e in f)if("length"!=e){d=b.force_types.length;for(found_types=0;0<d;)for(d--,g=f[e].length;0<g;)if(g--,b.force_types[d]===f[e][g].type){found_types++;break}found_types<b.force_types.length&&(delete f[e],f.length--)}if(!(2>f.length)){for(d=0;d<h.length;d++)if(f[h[d]]){a.src(f[h[d]]);
a.currentRes=h[d];break}"function"!==typeof a.localize&&(a.localize=function(a){return a});a.getCurrentRes=function(){if("undefined"!==typeof a.currentRes)return a.currentRes;try{return res=a.options().sources[0]["data-res"]}catch(b){return""}};a.changeRes=function(b){var c=a.el().firstChild,d=a.paused(),f=a.currentTime(),e;if(a.getCurrentRes()!=b&&a.availableRes&&a.availableRes[b]){"none"==c.preload&&(c.preload="metadata");a.src(a.availableRes[b]).one("loadedmetadata",function(){a.currentTime(f);
a.addClass("vjs-has-started");d||a.play()});a.currentRes=b;if(a.controlBar.resolutionSelector)for(c=a.controlBar.resolutionSelector.el().firstChild.children,e=c.length;0<e;)if(e--,"vjs-control-text"==c[e].className){c[e].innerHTML=k.res_label(b);break}a.trigger("changeRes")}};(e=a.getCurrentRes())&&(e=k.res_label(e));d=new c.ResolutionSelector(a,{buttonText:a.localize(e||"Quality"),available_res:f});a.controlBar.resolutionSelector=a.controlBar.addChild(d)}}})})(videojs);
